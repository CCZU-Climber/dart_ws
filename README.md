# dart_ws
RoboMaster é£é•–ç³»ç»Ÿ1

https://img.shields.io/badge/License-MIT-blue.svg
https://img.shields.io/badge/Platform-Embedded%2520%257C%2520ROS-orange.svg
https://img.shields.io/badge/Status-Under%2520Development-yellow.svg

    æœ¬é¡¹ç›®æ˜¯ä¸ºå¤§ç–† RoboMaster æœºç”²å¤§å¸ˆèµ›è®¾è®¡çš„é£é•–å‘å°„ç³»ç»Ÿã€‚å®ƒåŒ…å«äº†ä»ç›®æ ‡è¯†åˆ«ã€å¼¹é“è§£ç®—åˆ°å‘å°„æ§åˆ¶çš„å®Œæ•´è‡ªåŠ¨åŒ–è§£å†³æ–¹æ¡ˆã€‚

ğŸ“– ç›®å½•

    æ¦‚è¿°

    æ ¸å¿ƒç‰¹æ€§

    ç³»ç»Ÿæ¶æ„

    ç¡¬ä»¶ç»„æˆ

    è½¯ä»¶ä¾èµ–

    å®‰è£…ä¸ä½¿ç”¨

    é…ç½®è¯´æ˜

    API æ–‡æ¡£

    å¼€å‘æŒ‡å—

    ç»´æŠ¤ä¸è°ƒè¯•

    è´¡çŒ®

    è®¸å¯è¯

    è‡´è°¢

ğŸš€ æ¦‚è¿°

RoboMaster é£é•–æ˜¯ä¸€ç§è¿œç¨‹ã€é«˜ç²¾åº¦çš„æ‰“å‡»æ­¦å™¨ï¼Œé€šå¸¸ç”¨äºæ¯”èµ›ä¸­æ”»å‡»å¯¹æ–¹çš„â€œåŸºåœ°â€æˆ–â€œå“¨å…µâ€æœºå™¨äººã€‚æœ¬é¡¹ç›®æ—¨åœ¨å®ç°é£é•–çš„ è‡ªåŠ¨ç„å‡†ä¸å‘å°„ï¼Œé€šè¿‡èåˆè®¡ç®—æœºè§†è§‰ã€æƒ¯æ€§å¯¼èˆªå’Œå…ˆè¿›çš„æ§åˆ¶ç®—æ³•ï¼Œæå¤§æå‡æ“ä½œçš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚

æ ¸å¿ƒç›®æ ‡ï¼š å®ç°ä¸€é”®å¼â€œå‘ç°å³æ‘§æ¯â€çš„è‡ªåŠ¨åŒ–ä½œæˆ˜æµç¨‹ã€‚
âœ¨ æ ¸å¿ƒç‰¹æ€§

    é«˜ç²¾åº¦è§†è§‰è¯†åˆ«: åˆ©ç”¨æ·±åº¦å­¦ä¹ æˆ–ä¼ ç»Ÿè§†è§‰ç®—æ³•ï¼Œç¨³å®šè¯†åˆ«å¹¶è·Ÿè¸ªæ•Œæ–¹è£…ç”²æ¿ã€åŸºåœ°ç­‰ç›®æ ‡ã€‚

    å®æ—¶å¼¹é“è§£ç®—: ç»“åˆç›®æ ‡è·ç¦»ã€ç›¸å¯¹é€Ÿåº¦ã€é‡åŠ›ã€ç©ºæ°”é˜»åŠ›ç­‰å› ç´ ï¼Œå®æ—¶è®¡ç®—å°„å‡»è¯¸å…ƒã€‚

    å¤šæ¨¡å¼å‘å°„:

        è‡ªåŠ¨æ¨¡å¼: å…¨è‡ªåŠ¨ç„å‡†ä¸å‘å°„ã€‚

        æ‰‹åŠ¨æ¨¡å¼: æ“ä½œæ‰‹é€šè¿‡å›¾ä¼ æ‰‹åŠ¨ç„å‡†ï¼Œç³»ç»Ÿè¾…åŠ©è§£ç®—ã€‚

        å•å‘/è¿å‘: å¯é…ç½®å‘å°„ç­–ç•¥ã€‚

    å®‰å…¨äº’é”æœºåˆ¶: å…·å¤‡ç¡¬ä»¶ä¸è½¯ä»¶å¤šé‡å®‰å…¨ä¿æŠ¤ï¼Œé˜²æ­¢è¯¯è§¦å‘å’Œè¶…é™æ“ä½œã€‚

    çŠ¶æ€ç›‘æ§ä¸åé¦ˆ: å®æ—¶ç›‘æµ‹é£é•–èˆ±æ¸©åº¦ã€ç”µæœºè½¬é€Ÿã€å¼¹ä¸¸æ•°é‡ç­‰å…³é”®çŠ¶æ€ã€‚

    ROS é›†æˆ: é‡‡ç”¨ ROS (Robot Operating System) æ¡†æ¶ï¼Œæ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºä¸æœºå™¨äººå…¶ä»–ç³»ç»Ÿï¼ˆåº•ç›˜ã€äº‘å°ï¼‰é€šä¿¡ä¸ååŒã€‚

ğŸ— ç³»ç»Ÿæ¶æ„

ç³»ç»Ÿä¸»è¦åˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡ï¼š

    æ„ŸçŸ¥å±‚:

        æ‘„åƒå¤´: è·å–å›¾åƒæ•°æ®ã€‚

        IMU: æä¾›äº‘å°å§¿æ€è§’é€Ÿåº¦ã€åŠ é€Ÿåº¦æ•°æ®ã€‚

        æµ‹è·ä¼ æ„Ÿå™¨: (å¯é€‰) æ¿€å…‰æµ‹è·ä»ªç­‰ï¼Œè¾…åŠ©æµ‹è·ã€‚

    å†³ç­–å±‚:

        ä¸»æ§è®¡ç®—æœº (å¦‚ Jetson Nano/TX2, Manifold): è¿è¡Œè§†è§‰è¯†åˆ«ã€å¼¹é“è§£ç®—ã€å†³ç­–é€»è¾‘ã€‚

        å¾®æ§åˆ¶å™¨ (å¦‚ STM32): è´Ÿè´£åº•å±‚ç”µæœºæ§åˆ¶ã€ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†ã€é€šä¿¡æ”¶å‘ã€‚

    æ‰§è¡Œå±‚:

        æ‘©æ“¦è½®ç”µæœº: æä¾›å‘å°„åŠ¨åŠ›ã€‚

        æ‹¨å¼¹æœºæ„èˆµæœº/ç”µæœº: æ§åˆ¶ä¾›å¼¹ã€‚

        ç”µç£é“/å‡»å‘æœºæ„: æ§åˆ¶é£é•–é‡Šæ”¾ã€‚

        é€šè®¯æ¨¡å—: ä¸æœºå™¨äººä¸»æ§è¿›è¡Œæ•°æ®äº¤æ¢ã€‚

text

[æ‘„åƒå¤´] & [IMU] -> [ä¸»æ§è®¡ç®—æœº] --(ç›®æ ‡è§’åº¦/å‘å°„æŒ‡ä»¤)--> [STM32] -> [ç”µæœº & èˆµæœº]
                                                              |
                                                              <--[ç¼–ç å™¨åé¦ˆ & çŠ¶æ€æ•°æ®]--

ğŸ›  ç¡¬ä»¶ç»„æˆ
éƒ¨ä»¶	å‹å·/è§„æ ¼	å¤‡æ³¨
ä¸»æ§è®¡ç®—æœº	NVIDIA Jetson Nano/TX2	ç”¨äºè§†è§‰å¤„ç†ä¸å†³ç­–
å¾®æ§åˆ¶å™¨	STM32F4/F7ç³»åˆ—	è´Ÿè´£åº•å±‚æ§åˆ¶
è§†è§‰ä¼ æ„Ÿå™¨	å¤§ç–†å®˜æ–¹æ‘„åƒå¤´æˆ–å·¥ä¸šç›¸æœº	å…¨å±€å¿«é—¨ï¼Œé«˜å¸§ç‡
æƒ¯æ€§æµ‹é‡å•å…ƒ	MPU6050, ICM20602ç­‰	é›†æˆåœ¨äº‘å°ä¸Š
æ‘©æ“¦è½®ç”µæœº	RoboMaster M3508/M2006	æä¾›å‘å°„åˆé€Ÿåº¦
ç”µæœºé©±åŠ¨	C610/C620	
æ‹¨å¼¹æœºæ„	èˆµæœºæˆ–å°å‹ç”µæœº	
ç”µæºæ¨¡å—	24V to 5V/12V DCDC	ä¸ºå„æ¨¡å—ä¾›ç”µ
ğŸ’» è½¯ä»¶ä¾èµ–

    æ“ä½œç³»ç»Ÿ: Ubuntu 18.04/20.04 + ROS Noetic/Melodic

    ä¸­é—´ä»¶: ROS (roscpp, rospy, vision_msgs, sensor_msgs)

    è®¡ç®—æœºè§†è§‰:

        OpenCV (>= 4.2)

        TensorRT, PyTorch æˆ– TensorFlow (å¦‚æœä½¿ç”¨æ·±åº¦å­¦ä¹ )

        OpenVINO (å¯é€‰ï¼Œç”¨äºIntelç¡¬ä»¶åŠ é€Ÿ)

    å¼€å‘å·¥å…·:

        ARM GCC (ç”¨äºSTM32å¼€å‘)

        STM32CubeMX, Keil uVision

        Git

âš™ï¸ å®‰è£…ä¸ä½¿ç”¨
1. å…‹éš†ä»£ç åº“
bash

git clone https://github.com/your_username/robomaster-dart.git
cd robomaster-dart

2. å®‰è£…ROSä¾èµ–
bash

# å‡è®¾å·¥ä½œç©ºé—´ä¸º catkin_ws
cd ~/catkin_ws/src
catkin_init_workspace
cd ..
rosdep install --from-paths src --ignore-src -r -y

3. ç¼–è¯‘
bash

catkin_make
# æˆ–è€…
catkin build

4. ç¡¬ä»¶è¿æ¥

    è¿æ¥æ‘„åƒå¤´ã€IMUåˆ°ä¸»æ§è®¡ç®—æœºã€‚

    è¿æ¥STM32ä¸ç”µæœºã€èˆµæœºã€ç¼–ç å™¨ã€‚

    ç¡®ä¿æ‰€æœ‰ç”µæºè¿æ¥æ­£ç¡®ã€‚

5. è¿è¡Œ
bash

source devel/setup.bash
roslaunch dart_launch main.launch

ğŸ”§ é…ç½®è¯´æ˜

ä¸»è¦çš„é…ç½®æ–‡ä»¶ä½äº config/ ç›®å½•ä¸‹ï¼š

    vision_params.yaml: è§†è§‰è¯†åˆ«å‚æ•°ï¼ˆå¦‚HSVé˜ˆå€¼ã€ç›®æ ‡å¤§å°ã€ç¥ç»ç½‘ç»œæ¨¡å‹è·¯å¾„ï¼‰ã€‚

    ballistic_params.yaml: å¼¹é“è§£ç®—å‚æ•°ï¼ˆå¦‚åˆé€Ÿåº¦ã€é‡åŠ›è¡¥å¿ã€é£é˜»ç³»æ•°ï¼‰ã€‚

    control_params.yaml: æ§åˆ¶å‚æ•°ï¼ˆå¦‚PIDå‚æ•°ã€å‘å°„å»¶æ—¶ï¼‰ã€‚

    hardware_params.yaml: ç¡¬ä»¶æ¥å£å‚æ•°ï¼ˆå¦‚CAN IDï¼Œ ä¸²å£å·ï¼‰ã€‚

è¯·æ ¹æ®å®é™…ç¡¬ä»¶å’Œèµ›åœºç¯å¢ƒä»”ç»†è°ƒæ•´è¿™äº›å‚æ•°ã€‚
ğŸ“š API æ–‡æ¡£
ä¸»é¢˜ (Topics)

    è®¢é˜…:

        /camera/image_raw (sensor_msgs/Image): åŸå§‹å›¾åƒæ•°æ®ã€‚

        /imu/data (sensor_msgs/Imu): IMUæ•°æ®ã€‚

        /cmd_dart_fire (std_msgs/Bool): æ¥è‡ªæ“ä½œæ‰‹çš„å‘å°„æŒ‡ä»¤ã€‚

    å‘å¸ƒ:

        /dart/target_info (vision_msgs/Detection2DArray): è¯†åˆ«åˆ°çš„ç›®æ ‡ä¿¡æ¯ã€‚

        /dart/status (dart_msgs/DartStatus): é£é•–ç³»ç»ŸçŠ¶æ€ï¼ˆæ¸©åº¦ã€å¼¹é‡ç­‰ï¼‰ã€‚

æœåŠ¡ (Services)

    /dart/set_fire_mode (SetInt32): è®¾ç½®å‘å°„æ¨¡å¼ï¼ˆ0-æ‰‹åŠ¨ï¼Œ1-è‡ªåŠ¨ï¼‰ã€‚

ğŸ‘¨â€ğŸ’» å¼€å‘æŒ‡å—

    ä»£ç ç»“æ„:
    text

robomaster-dart/
â”œâ”€â”€ dart_vision/      # è§†è§‰è¯†åˆ«åŒ…
â”œâ”€â”€ dart_control/     # æ§åˆ¶å†³ç­–åŒ…
â”œâ”€â”€ dart_driver/      # STM32åº•å±‚é©±åŠ¨åŒ…
â”œâ”€â”€ dart_description/ # URDFæ¨¡å‹æ–‡ä»¶
â”œâ”€â”€ config/           # é…ç½®æ–‡ä»¶
â””â”€â”€ launch/           # ROSå¯åŠ¨æ–‡ä»¶

    æ‰©å±•æ–°åŠŸèƒ½:

        è¦æ·»åŠ æ–°çš„è§†è§‰ç®—æ³•ï¼Œè¯·åœ¨ dart_vision ä¸­åˆ›å»ºæ–°çš„èŠ‚ç‚¹ã€‚

        è¦ä¿®æ”¹æ§åˆ¶é€»è¾‘ï¼Œè¯·æŸ¥çœ‹ dart_control/src/decision_node.cppã€‚

ğŸ› ç»´æŠ¤ä¸è°ƒè¯•

    å¸¸è§é—®é¢˜:

        è¯†åˆ«ä¸ç¨³å®š: æ£€æŸ¥å…‰ç…§æ¡ä»¶ï¼Œé‡æ–°æ ¡å‡†ç›¸æœºï¼Œè°ƒæ•´è§†è§‰å‚æ•°ã€‚

        å°„å‡»ç²¾åº¦å·®: æ£€æŸ¥æ‘©æ“¦è½®ç£¨æŸæƒ…å†µï¼Œæ ¡å‡†å¼¹é“å‚æ•°ï¼Œæ£€æŸ¥IMUæ•°æ®æ˜¯å¦å‡†ç¡®ã€‚

        é€šè®¯ä¸­æ–­: æ£€æŸ¥CANæ€»çº¿æˆ–ä¸²å£è¿æ¥ï¼Œç¡®è®¤æ³¢ç‰¹ç‡è®¾ç½®ã€‚

    æ—¥å¿—:

        ROS æ—¥å¿—å­˜å‚¨åœ¨ ~/.ros/log/ã€‚

        ä½¿ç”¨ rqt_console æŸ¥çœ‹å®æ—¶æ—¥å¿—ã€‚

ğŸ¤ è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼

    Fork æœ¬ä»“åº“ã€‚

    åˆ›å»ºæ‚¨çš„åŠŸèƒ½åˆ†æ”¯ (git checkout -b feature/AmazingFeature)ã€‚

    æäº¤æ‚¨çš„æ›´æ”¹ (git commit -m 'Add some AmazingFeature')ã€‚

    æ¨é€åˆ°åˆ†æ”¯ (git push origin feature/AmazingFeature)ã€‚

    å¼€å¯ä¸€ä¸ª Pull Requestã€‚

ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ LICENSE æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚
ğŸ™ è‡´è°¢

    æ„Ÿè°¢ DJI æä¾› RoboMaster è¿™ä¸ªä¼˜ç§€çš„å¹³å°ã€‚

    æ„Ÿè°¢ [ç›¸å…³å¼€æºé¡¹ç›®/åº“] æä¾›çš„æ”¯æŒã€‚

    æ„Ÿè°¢ [ä½ çš„æˆ˜é˜Ÿå] å…¨ä½“é˜Ÿå‘˜çš„åŠªåŠ›ä¸è´¡çŒ®ã€‚
